PROTEIN DOMAIN ANALYSIS ON GENOMES
===================================

## Settings 

We will use "uv" to run snakemake because it is the easisest way of managing python pacakges and versions especially when we hav no root permission.

Type :
```
uv init
uv add pandas
uv add hmmer
uv add Bio
```

R has to be installed with the package Biostrings

## Configuration files

- `analyse.json` file :

```
{ 
  "mode": "",  
  "storagetype": "irods",
  "analyse_dir_name": "verif/",
  "resources_dir_name": "protein_domain_PRDM9/", 
  "domain_references" : {
"SET":"Domain_SET_ReferenceAlignment2024",
"KRAB":"Domain_KRAB_ReferenceAlignment2024",
"SSXRD":"Domain_SSXRD_ReferenceAlignment2024",
"ZF":"Domain_ZF_unit_ReferenceAlignment2024"
},
  "domains" :  ["SET"],    
  "domains_simple" : ["SSXRD","ZF","KRAB"],
}

```
> [!CAUTION]
> "analyse_dir_name" describes the directory win which the  results are stored. It should be modified for each analyse! 



> "resources_dir_name"  describes the  directory in which the  data about domains is stored. The directoy is located in "pathGTDriftResource". It must be structured as follows:

```
RESOURCES_DIR_NAME/
...........reference_alignments/ (should be present at start)
.............................. DOMAIN1/
..................................... Reference_alignement_DOMAIN1.fst
......................................[Paralogous_alignement_DOMAIN1.fst](if DOMAIN1 is selected for paralogous analysis) 
......................................[Paralogous_alignement_DOMAIN1.fst](if DOMAIN1 is selected for paralogous analysis) 
...............................DOMAIN2/
.......................................Reference_alignement_DOMAIN2.fst
.......................................[Paralogous_alignement_DOMAIN2.fst](if DOMAIN2 is selected for paralogous analysis) 
.......................................[Paralogous_alignement_DOMAIN2.fst](if DOMAIN2 is selected for paralogous analysis) 
...........hmm_profiles/ (will be generated by the pipeline)
........................DOMAIN1/
............................... Reference_alignement_DOMAIN1.hmm
................................[Paralogous_alignement_DOMAIN1.hmm](if DOMAIN1 is selected for paralogous analysis) 
................................[Paralogous_alignement_DOMAIN1.hmm](if DOMAIN1 is selected for paralogous analysis) 
........................DOMAIN2/
................................Reference_alignement_DOMAIN2.hmm
............................... [Paralogous_alignement_DOMAIN2.hmm](if DOMAIN2 is selected for paralogous analysis) 
................................[Paralogous_alignement_DOMAIN2.hmm](if DOMAIN2 is selected for paralogous analysis) 
...........hmm_databases/ (will be generated by the pipeline)
........................[database_DOMAIN1.hmm{.h3i,.h3f,.h3m.h3p}] (if DOMAIN1 is selected for paralogous analysis)
........................[database_DOMAIN2.hmm{.h3i,.h3f,.h3m.h3p}] (if DOMAIN2 is selected for paralogous analysis)
```
> "domain_references" provides for each domain the reference alignment. This alignement is used to build the hmm profile needed for the hmm search for candidates, and to discriminate paralogs ('Best matches")     

> "domains" provides  the list of domains for which a hmm search and a paralogy analysis will be performed

> "domains_simple" provides  the list of domains for which a hmm search  will be performed

- `assemblies.json` file :
  The file contains the list of assemblies to be processed.



## Run the domains analysis on protein data

`uv run snakemake -s ../utils/process_genewise.smk  --jobs 1`

## Run the  analysis of the ZF domain on protein data

`uv run snakemake -s ../utils/process_zincfinger_genewise.smk  --jobs 1`

## Run the analysis of the ZF domain on the dna sequence  coding for the protein data

`uv run snakemake -s ../utils/process_zincfinger_dna_genewise.smk  --jobs 1`

